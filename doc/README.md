# MeeHatドキュメント
## 機能
### ワークスペース
下記のチャット機能もビデオミーティング機能もこのワークスペースごとに行われます。<br>
ワークスペースには以下のロールが存在します。デフォルトは一般です。
- オーナー： 管理者が持つ権限全て、＋ワークスペースの閉鎖
- 管理者：パブリックチャンネルの作成、チャンネルをワークスペース外への共有、ユーザーをワークスペースから削除する
- 一般：チャット・ビデオミーティングへの参加及び会話、パブリックチャンネルを除くチャンネルの作成、リアクション、カスタム絵文字の追加、ピン留め

オーナーもしくは管理者であってもプライベートチャンネルの参加・閲覧、参加していないダイレクトメッセージの閲覧はできません。<br>
ワークスペースに参加するには、参加用のURLを貰うもしくは招待コードを入力する必要があります。

### チャット機能
- チャンネルもしくはダイレクトメッセージで会話を行います
- チャンネルには以下のプロパティがあります
    - 種類：テキストチャンネル、ボイスチャンネル
        - テキストチャンネル：テキストベースでの会話を楽しめます
        - ボイスチャンネル：音声もしくは映像での会話を楽しめます。ビデオミーティング機能との違いは[ビデオミーティング機能](###ビデオミーティング機能)を参照
    - 可視性：パブリック、パーティシペーション、プライベート
        - パブリック：ワークスペース内のユーザー全員が参加するチャンネル
        - パーティシペーション：自分で参加することで見ることができるチャンネル
        - プライベート：招待を受けることで見ることができるチャンネル
    - ワークスペース外共有：ワークスペース外のユーザーと共有できます（管理者のみ可能）
- 絵文字での会話が可能です
- 他の人のメッセージにリアクションを付けることもできます
- ワークスペースごとにカスタム絵文字を追加できます
- 発言をチャンネルごとにピン留めすることができます
    - ピン留め：全ユーザーに共有されます
- 発言をワークスペースごとにブックマークできます
    - ブックマーク：あなただけに表示され、ピン留めと違いブックマークは共有されません
- スレッド：ある発言内に別のチャンネルを追加するようにスレッドを立てることができます
- 返信：ある発言に対してチャンネル全体で返信します

### ダイレクトメッセージでの音声通話
ダイレクトメッセージで音声通話もしくはビデオ通話を開始することができます。<br>
これは通常の電話と同じで相手に即時通知が飛び、相手に通話がかかっていることを知らせます。

### ビデオミーティング機能
音声もしくは映像での会話を行えます。
- 音声での会話
- Webカメラの使用
- 画面共有
- 個別のユーザーごとに音量を調整

#### ボイスチャンネルとビデオミーティングの違い
ボイスチャンネルは事前に予告せずフリーに会話を楽しむ用途に向きます。<br>
一方、ビデオミーティングは会議など事前に予告があるような用途に向きます。<br>
できることは同じです。<br>
ビデオミーティングではデフォルトでカメラがオンですが、ボイスチャンネルはオフです。<br>
また、ビデオミーティングはテキストチャンネルで開始され、そのテキストチャンネルにいる全ての人にリマインドされる他、ワークスペース外の人にも簡単に共有できます。（共有は管理者のみ可能）

## アカウント設計
アカウントはワークスペースごとに存在します。これはワークスペースに参加する際に生成され、ワークスペースごとにプロフィールを変更できます。<br>
しかし、ユーザーはMeeHatを使うにあたって、自分でログイン用のアカウントを１つ作る必要があります。自身でつくったアカウントをルートアカウントと呼び、その配下にワークスペースごとのアカウントが連なる形です。<br>
このルートアカウントは自分個人のメールアドレスで作るのが望ましく、所属する組織のメールアドレスを使うのはワークスペースのアカウントに使いましょう。<br>
なお、ルートアカウントの情報はワークスペースのオーナーであっても確認することはできません。確認できるのはワークスペースのアカウントのみです。<br>
```
ルートアカウント
|---- ワークスペース１のアカウント
|---- ワークスペース２のアカウント
|---- ワークスペース３のアカウント
etc...
```

## ログイン機能
パスワードレスを目指し、メールアドレスを用いた認証とする。

## URL設計
### /
トップページはMeeHatの紹介ページとする。<br>
この部分はReactは使わない。またRailsでほぼ静的ページにする。<br>
[参考ページ](https://railstutorial.jp/chapters/static-pages?version=3.2)

### /api
MeeHatのWebAPI配下<br>
後述のゲートウェイを除いて、すべてJSONで返される。

### /app
MeeHatのWebアプリケーションページ<br>
このURL配下はReactを用いてCSRで開発する。<br>
設定画面などはポップアップで制作し、URLは割り振らない。

### /admin
MeeHatのAdminページ<br>
SPAほどのリッチさはいらないことから、Hotwireを用いてSSRで開発する。

```
.
|---- api
|     |---- v1
|           |---- Gateway: ゲートウェイ
|           |---- accounts
|                  |---- Login: ログイン
|                  |---- Regist: アカウント登録用
|                  |---- ResetPassword: パスワードリセット
|                  |---- ChangePassword: パスワード変更
|                  |---- ChangeEmail: メールアドレス変更
|                  |---- Delete: アカウント削除
|           |---- users
|                  |---- Settings: 設定関係
|                  |---- ユーザーID: ユーザー情報系
|           |---- workspaces
|                  |---- List: 参加しているワークスペースを一覧で返す
|                  |---- Join: ワークスペースに参加する
|                  |---- Create: ワークスペースを作成する
|                  |---- ワークスペースID: ワークスペースの情報
|                         |---- Settings: ワークスペースの設定関係
|                         |---- チャンネルID: チャンネルの情報
|                                |---- Settings: チャンネルの設定関係
|                                |---- Messages: メッセージ
|                                |---- Reaction: リアクション
|
|---- app
|     |---- ワークスペースID
|           |---- チャンネルID
|
|---- admin
```